{% extends "AI_Fraud_Detection/base2.html" %}
{% load crispy_forms_tags %}
{% block content %}

<div class="col-lg-8 mb-4">
  <div class="row">
      {% autoescape off %}
      {{ plot_div1 }}
      {% endautoescape %}
  </div>
</div>

<!--
<div class="col-lg-8 mb-4">
  <div class="row">
    <div class="col-lg-4 mb-4">
      <div class="card h-100">
        <h6 class="card-header">File Scanned</h6>
        <div class="card-body">
          <div class="display-5">{{file_count}}</div>
        </div>
      </div>
    </div>

    <div class="col-lg-4 mb-4">
      <div class="card h-100">
        <h6 class="card-header">False Positive</h6>
        <div class="card-body">
          <div class="display-5">{{fp_sum}}</div>
        </div>
      </div>
    </div>

    <div class="col-lg-4 mb-4">
      <div class="card h-100">
        <h6 class="card-header">Suspicious Detected</h6>
        <div class="card-body">
          <div class="display-5">{{f_sum}}</div>
        </div>
      </div>
    </div>

    <div class="col-lg-4 mb-4">
      <div class="card h-100">
        <h6 class="card-header">New Customers</h6>
        <div class="card-body">
          <div class="display-5">{{n_sum}}</div>
        </div>
      </div>
    </div>
  </div>
-->
  <hr><br>
  <form method="POST" enctype="multipart/form-data" action="prediction">
      {% csrf_token %}
      <fieldset class="form-group">
          <legend class="border-bottom mb-4">False Positive Identification</legend>
          <p>
            To identify the false positive alerts, please upload the extract generated from the AML tool with the customer details of the suspected fraudelent customers.                  
          </p>
          <p>
            The extract generated by this tool will provide you the False Positive alerts generated by the AML system. This extract can be used to close the false positive alerts in the AML system.
          </p>                
              <input type='file' name="document" class="btn btn-outline-info">  
              {% if prediction %}                  
              <div class="border-top pt-3">
                  <small class="text-muted">File Name : {{uploaded_file.name}}</small>
              </div>
              {% endif %}                                    
      </fieldset>
      <div class="form-group">
          <button class="btn btn-outline-info" type="submit">Classify</button>
      </div>
      <a class="nav-link" href="{% url 'PredictData' %}">Click to view Prediction History</a>
  </form>
  {% if prediction %}

    <div class="row mt-4 mb-3">
      <p>
        <mark>False positive percentage reduced <kbd>{{fp_percent}}</kbd></mark>
      </p>
      <table class="table table-light table-striped">
        <thead> 
          <tr> 
            <th>Classification</th> 
            <th>Count</th>                   
          </tr> 
        </thead> 
        <tbody> 
          <tr> 
            <td>False Positive</td> 
            <td>
              {{fp_count}}
            </td>                   
          </tr>
          <tr> 
            <td>Suspicious</td> 
            <td>
              {{f_count}}
            </td>                   
          </tr>
          <tr> 
            <td>New Customer</td> 
            <td>
              {{n_count}}
            </td>                   
          </tr>
        </tbody>
      </table>
    </div>

    <div>
      {% autoescape off %}
      {{ plot_div }}
      {% endautoescape %}
    </div>
  <div class="row mt-4 mb-3">
  <h3>Classification Data</h3>
  <small>
    <a href="/media/output.csv">Download file</a>
  </small>
  <table class="table table-light table-striped"> 
      <thead> 
        <tr> 
          <th>First Name</th> 
          <th>Last Name</th> 
          <th>Classification</th> 
        </tr> 
      </thead> 
      <tbody> 
      <!-- jinja2 Technique -->
          
      {% for i in prediction %} 
        <tr> 
          <td>{{i.First_Name}}</td> 
          <td>{{i.Last_Name}}</td> 
          <td>{{i.label}}</td>
        </tr> 
      {% endfor %} 
  {% endif %} 
      </tbody> 
    </table> 
  </div>
</div>
{% endblock content %}